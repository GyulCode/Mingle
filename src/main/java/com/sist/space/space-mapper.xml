<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.sist.space.SpaceMapper">
   <select id="spaceListByCategory" resultType="SpaceVO" parameterType="hashmap">
    SELECT space_id, category, poster, title, price, max_guest, num
    FROM (SELECT space_id, category, poster, title, price, max_guest, rownum as num
        FROM (SELECT /*+INDEX_DESC(space_list PK_SPACE_LIST)*/ space_id, category, poster, title, price, max_guest
            FROM space_list
            <if test="category!='all'">
              WHERE category=#{category}
            </if>
        ))
    WHERE num BETWEEN #{start} AND #{end}
   </select>
   <select id="spaceTotalpage" resultType="int" parameterType="hashMap">
     SELECT CEIL(COUNT(*)/12.0) FROM space_list
     <if test="category!='all'">
       WHERE category=#{category}
     </if>
   </select>
 </mapper>
